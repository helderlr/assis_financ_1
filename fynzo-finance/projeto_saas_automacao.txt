VisÃ£o Geral do Sistema

Landing Page com checkout integrado.

ApÃ³s o pagamento:

Criar projeto no Supabase.

Armazenar dados do cliente.

Conectar celular Ã  Evolution API (via VPS).

Acionar fluxo N8N para ativar automaÃ§Ã£o.

CobranÃ§a mensal recorrente.

Se falhar o pagamento, a instÃ¢ncia Ã© bloqueada via API.

 Roteiro Passo a Passo
1. ğŸ¨ Criar a Landing Page
Campos:

Nome

Email

Celular (WhatsApp)

Nome do projeto

BotÃ£o "Assinar agora"

Direciona para checkout (Stripe ou Mercado Pago)

2. ğŸ’³ IntegraÃ§Ã£o de Pagamento
ğŸ”¹ Stripe (Recomendado para SaaS)
Plano com cobranÃ§a mensal recorrente

Webhook de evento:

checkout.session.completed â†’ aciona backend para provisionar

invoice.payment_failed â†’ desativa instÃ¢ncia

ğŸ”¹ Mercado Pago (opÃ§Ã£o BR)
Assinatura recorrente com webhooks semelhantes

Precisa tratar falhas e cancelamentos via cron job

3. ğŸ”„ PÃ³s-Pagamento (Provisionamento)
Webhook â†’ API do seu backend â†’ ExecuÃ§Ã£o:

Criar usuÃ¡rio e projeto no Supabase via REST API ou SDK.

Gravar dados do cliente e status de pagamento.

Chamar Evolution API com POST /register usando nÃºmero do cliente.

Enviar payload ao N8N (via webhook) para iniciar a automaÃ§Ã£o.

4. ğŸ”’ Controle de Acesso
Backend agenda verificaÃ§Ã£o de pagamentos com cron (diÃ¡rio):

Se assinatura estiver "unpaid" ou cancelada:

Chamar Evolution API com DELETE /disconnect/:celular

Atualizar status no Supabase: inativo

5. ğŸ§¾ Dashboard/Admin
Opcional:

Tela para vocÃª ver:

Clientes ativos/inativos

HistÃ³rico de pagamentos

Log de provisionamento

Pode ser feito com:

Supabase + React

Painel simples em Next.js

ğŸ“¦ OrganizaÃ§Ã£o do Projeto
/frontend
  - PÃ¡gina de venda
  - PÃ¡gina de sucesso/erro

/backend
  - /api/checkout (cria link)
  - /api/webhook (Stripe)
  - /api/provision (chama Supabase + Evolution + N8N)
  - /api/block (em caso de inadimplÃªncia)

scripts/
  - cronCheckPayments.js
ğŸ›¡ï¸ SeguranÃ§a
Use tokens de autenticaÃ§Ã£o para:

Supabase (admin key)

Evolution API (chave privada no VPS)

N8N Webhook com secret